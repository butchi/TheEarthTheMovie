!function e(t,n,i){function a(o,s){if(!n[o]){if(!t[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return a(n?n:e)},d,d.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){i(this,e),this.startDate=t.start_date||new Date(-621355968e5),this.endDate=t.end_date||new Date,this.duration=this.endDate.valueOf()-this.startDate.valueOf(),this.$btnPlay=t.$btn_play,this.$slider=t.$slider,this.PlayerState={ENDED:0,PLAYING:1,PAUSED:2},this.$dispatcher=$({}),this._state,this.initialize()}return a(e,[{key:"initialize",value:function(){this.curDate=this.startDate}},{key:"playVideo",value:function(){var e=this;this._state=this.PlayerState.PLAYING,this.triggerStateChange(),this.timerId=setInterval(function(){e.curDate.valueOf()>=e.endDate.valueOf()&&e.stopVideo(),e.curDate=new Date(e.curDate.valueOf()+1e3)},1e3)}},{key:"pauseVideo",value:function(){clearInterval(this.timerId),this._state=this.PlayerState.PAUSED,this.triggerStateChange()}},{key:"stopVideo",value:function(){clearInterval(this.timerId),this._state=this.PlayerState.ENDED,this.triggerStateChange(),this.$btnPlay.addClass("pause"),this.seekTo(this.startDate),this.$slider.val(0)}},{key:"seekTo",value:function(e){this.curDate=e}},{key:"getPlayerState",value:function(){return this._state}},{key:"getCurrentTime",value:function(){return this.curDate}},{key:"getDuration",value:function(){return this.duration}},{key:"triggerStateChange",value:function(){this.$dispatcher.trigger("onStateChange",this._state)}}]),e}();n["default"]=r},{}],2:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(){c=document.getElementById("container"),f=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,1,2e3),f.position.z=500,w=new THREE.Scene,p=new THREE.Group,w.add(p);var e=new THREE.TextureLoader;e.load("/img/land_ocean_ice_cloud_2048.jpg",function(e){var t=new THREE.SphereGeometry(200,20,20),n=new THREE.MeshBasicMaterial({map:e,overdraw:.5}),i=new THREE.Mesh(t,n);p.add(i)});var t=document.createElement("canvas");t.width=128,t.height=128;var n=t.getContext("2d"),i=n.createRadialGradient(t.width/2,t.height/2,0,t.width/2,t.height/2,t.width/2);i.addColorStop(.1,"rgba(210,210,210,1)"),i.addColorStop(1,"rgba(255,255,255,1)"),n.fillStyle=i,n.fillRect(0,0,t.width,t.height);var a=new THREE.CanvasTexture(t),s=new THREE.PlaneBufferGeometry(300,300,3,3),u=new THREE.MeshBasicMaterial({map:a,overdraw:.5}),l=new THREE.Mesh(s,u);l.position.y=-250,l.rotation.x=-Math.PI/2,p.add(l),v=new THREE.CanvasRenderer,v.setClearColor(16777215),v.setPixelRatio(window.devicePixelRatio),v.setSize(window.innerWidth,window.innerHeight),c.appendChild(v.domElement),h=new Stats,h.domElement.style.position="absolute",h.domElement.style.top="0px",c.appendChild(h.domElement),document.addEventListener("mousemove",o,!1),window.addEventListener("resize",r,!1)}function r(){D=window.innerWidth/2,C=window.innerHeight/2,f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),v.setSize(window.innerWidth,window.innerHeight)}function o(e){E=e.clientX-D,m=e.clientY-C}function s(){requestAnimationFrame(s),u(),h.update()}function u(){f.position.x+=.05*(E-f.position.x),f.position.y+=.05*(-m-f.position.y),f.lookAt(w.position),p.rotation.y-=.005,v.render(w,f)}function l(e){var t=e.getUTCFullYear()+"年"+(e.getUTCMonth()+1)+"月"+e.getUTCDate()+"日 "+("00"+e.getUTCHours()).slice(-2)+":"+("00"+e.getUTCMinutes()).slice(-2)+":"+("00"+e.getUTCSeconds()).slice(-2);return t}function d(){var e=T.getCurrentTime();P=(e.valueOf()-T.startDate.valueOf())/T.duration,k.text(l(e)),x.text(l(e)),T.getPlayerState()===T.PlayerState.PLAYING&&H.val(P),requestAnimationFrame(d)}var c,h,f,w,v,p,g=e("./Player"),y=i(g),E=0,m=0,D=window.innerWidth/2,C=window.innerHeight/2;a(),s();var T,P,S=new Date(2016,3,30,22,4,33),_=new Date(-621355968e5),H=$(".slider"),k=$(".face .time time"),x=$(".controller .time-cur"),R=$(".controller .time-total"),O=$(".controller .btn-gotohead"),b=$(".controller .btn-play");requestAnimationFrame(d),R.text(l(S)),H.on("input",function(){var e=$(this).val();T.seekTo(new Date(T.startDate.valueOf()+T.duration*e)),d()}),H.on("change",function(){T.$dispatcher.trigger("update"),T.seekTo(new Date(_.valueOf()+(S.valueOf()-_.valueOf())*P))}),b.on("click",function(){var e=$(this);e.hasClass("pause")?(e.removeClass("pause"),T.playVideo()):(e.addClass("pause"),T.pauseVideo())}),O.on("click",function(){T.seekTo(_),H.val(0)}),T=new y["default"]({start_date:_,end_date:S,$btn_play:b,$slider:H}),T.playVideo(),T.$dispatcher.on("onStateChange",function(e,t){console.log("state:",t)})},{"./Player":1}]},{},[2]);